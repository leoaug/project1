!function(){"use strict";function a(a,b){var c=null,d=function(a){if(c&&!(a&&"disabled"===c.getAutoClose()||a&&3===a.which)){var d=c.getToggleElement();if(!(a&&d&&d[0].contains(a.target))){var e=c.getDropdownElement();a&&"outsideClick"===c.getAutoClose()&&e&&e[0].contains(a.target)||(c.isOpen=!1,b.$$phase||c.$apply())}}},e=function(a){27===a.which?(c.focusToggleElement(),d()):c.isKeynavEnabled()&&-1!==[38,40].indexOf(a.which)&&c.isOpen&&(a.preventDefault(),a.stopPropagation(),c.focusDropdownEntry(a.which))};this.open=function(b){c||(a.on("click",d),a.on("keydown",e)),c&&c!==b&&(c.isOpen=!1),c=b},this.close=function(b){c===b&&(c=null,a.off("click",d),a.off("keydown",e))}}function b(a,b,c,d,e,f,g,h,i,j,k){var l,m,n=this,o=a.$new(),p=e.appendToOpenClass,q=e.openClass,r=angular.noop,s=c.bbOnToggle?d(c.bbOnToggle):angular.noop,t=!1,u=null,v=!1,w=i.find("body");b.addClass("dropdown"),this.init=function(){if(c.bbAlign&&b.addClass("dropdown--"+c.bbAlign),c.bbPlacement&&b.addClass("dropdown--"+c.bbPlacement),"true"===c.bbNoArrow&&b.addClass("dropdown--no-arrow"),c.bbIsOpen&&(m=d(c.bbIsOpen),r=m.assign,a.$watch(m,function(a){o.isOpen=!!a})),angular.isDefined(c.bbAppendTo)){var e=d(c.bbAppendTo)(o);e&&(u=angular.element(e))}t=angular.isDefined(c.bbAppendToBody),v=angular.isDefined(c.bbKeyboardNav),t&&!u&&(u=w),u&&n.dropdownMenu&&(u.append(n.dropdownMenu),b.on("$destroy",function(){n.dropdownMenu.remove()}))},this.toggle=function(a){return o.isOpen=arguments.length?!!a:!o.isOpen},this.isOpen=function(){return o.isOpen},o.getToggleElement=function(){return n.toggleElement},o.getAutoClose=function(){return c.bbAutoClose||"always"},o.getElement=function(){return b},o.isKeynavEnabled=function(){return v},o.focusDropdownEntry=function(a){var c=n.dropdownMenu?angular.element(n.dropdownMenu).find("a"):b.find("ul").eq(0).find("a");switch(a){case 40:angular.isNumber(n.selectedOption)?n.selectedOption=n.selectedOption===c.length-1?n.selectedOption:n.selectedOption+1:n.selectedOption=0;break;case 38:angular.isNumber(n.selectedOption)?n.selectedOption=0===n.selectedOption?0:n.selectedOption-1:n.selectedOption=c.length-1}c[n.selectedOption].focus()},o.getDropdownElement=function(){return n.dropdownMenu},o.focusToggleElement=function(){n.toggleElement&&n.toggleElement[0].focus()},o.$watch("isOpen",function(c,d){if(u&&n.dropdownMenu){var e,i,m=h.positionElements(b,n.dropdownMenu,"bottom-left",!0);if(e={top:m.top+"px",display:c?"block":"none"},i=n.dropdownMenu.hasClass("dropdown__menu--right"),i?(e.left="auto",e.right=window.innerWidth-(m.left+b.prop("offsetWidth"))+"px"):(e.left=m.left+"px",e.right="auto"),!t){var v=h.offset(u);e.top=m.top-v.top+"px",i?e.right=window.innerWidth-(m.left-v.left+b.prop("offsetWidth"))+"px":e.left=m.left-v.left+"px"}n.dropdownMenu.css(e)}var w=u||b;if(w.hasClass(u?p:q)===!c&&g[c?"addClass":"removeClass"](w,u?p:q).then(function(){angular.isDefined(c)&&c!==d&&s(a,{open:!!c})}),c)n.dropdownMenuTemplateUrl&&k(n.dropdownMenuTemplateUrl).then(function(a){l=o.$new(),j(a.trim())(l,function(a){var b=a;n.dropdownMenu.replaceWith(b),n.dropdownMenu=b})}),o.focusToggleElement(),f.open(o);else{if(n.dropdownMenuTemplateUrl){l&&l.$destroy();var x=angular.element('<ul class="dropdown__menu"></ul>');n.dropdownMenu.replaceWith(x),n.dropdownMenu=x}f.close(o),n.selectedOption=null}angular.isFunction(r)&&r(a,c)}),a.$on("$locationChangeSuccess",function(){"disabled"!==o.getAutoClose()&&(o.isOpen=!1)})}function c(){function a(a,b,c,d){d.init()}return{controller:"bbDropdownController",link:a}}function d(){function a(a,b,c,d){if(d&&!angular.isDefined(c.bbNested)){d.btnHasMargin&&b.css("margin-top",0),b.addClass("dropdown__menu");var e=c.bbTemplateUrl;e&&(d.dropdownMenuTemplateUrl=e),d.dropdownMenu||(d.dropdownMenu=b)}}return{link:a,require:"?^bbDropdown",restrict:"A"}}function e(a){function b(b,c,d,e){if(e){a.getComputedStyle(c[0],null).getPropertyValue("margin-bottom").replace("px","")>0&&(e.btnHasMargin=!0),c.addClass("dropdown__toggle"),e.toggleElement=c;var f=function(a){a.preventDefault(),c.hasClass("is-disabled")||d.disabled||b.$apply(function(){e.toggle()})};c.attr({"aria-haspopup":!0,"aria-expanded":!1}),b.$watch(e.isOpen,function(a){c.attr("aria-expanded",!!a)}),c.bind("click",f),b.$on("$destroy",function(){c.unbind("click",f)})}}return{link:b,require:"?^bbDropdown"}}angular.module("bb.dropdown",["bb.position"]).constant("bbDropdownConfig",{appendToOpenClass:"bb-dropdown-open",openClass:"is-open"}).service("bbDropdownService",a).controller("bbDropdownController",b).directive("bbDropdown",c).directive("bbDropdownMenu",d).directive("bbDropdownToggle",e),a.$inject=["$document","$rootScope"],b.$inject=["$scope","$element","$attrs","$parse","bbDropdownConfig","bbDropdownService","$animate","$bbPosition","$document","$compile","$templateRequest"],e.$inject=["$window"]}();